# –ö—Ä–∞—Ç–∫–∏–π –æ—Ç—á—ë—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏:**
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ `app/models/email_log.rb` (–Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `if` –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤ —Ö–µ—à–µ)
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è RedisCacheStore –≤ `rack_attack.rb` –∏ `redis.rb` (–¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è MemoryStore)
   - –î–æ–±–∞–≤–ª–µ–Ω require –¥–ª—è EncryptoSigno –≤ —Ç–µ—Å—Ç–∞—Ö
   - –û–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è ENV –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (–≤ —Ç–µ—Å—Ç–∞—Ö —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è)

2. **–¢–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è:**
   - RSpec —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
   - –¢–µ—Å—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è (–æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

## ‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ email_log.rb** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞
2. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è RuboCop —É—Å—Ç–∞—Ä–µ–ª–∞** ‚Äî –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å `.rubocop.yml`
3. **Health endpoint –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 500** ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ, –Ω–µ —Å–æ–∑–¥–∞–Ω–∞ —Ç–µ—Å—Ç–æ–≤–∞—è –ë–î
4. **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ eager_load** ‚Äî –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å test environment

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. –û–±–Ω–æ–≤–∏—Ç—å `.rubocop.yml` (—É–±—Ä–∞—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
2. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –ë–î –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Ç–µ—Å—Ç–æ–≤
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `config/environments/test.rb` –¥–ª—è eager_load
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

## üöÄ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# 1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å .rubocop.yml (—É–±—Ä–∞—Ç—å Metrics/LineLength, –æ–±–Ω–æ–≤–∏—Ç—å require –Ω–∞ plugins)

# 2. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –ë–î
docker compose exec api bash -c "cd /app && RAILS_ENV=test bundle exec rails db:create db:migrate"

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ ENV
docker compose exec api bash -c "cd /app && RAILS_ENV=test POSTAL_WEBHOOK_PUBLIC_KEY='test_key' bundle exec rspec --format documentation"

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å RuboCop (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥–∞)
docker compose exec api bundle exec rubocop

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å Brakeman
docker compose exec api bundle exec brakeman --no-pager
```

## üìä –°—Ç–∞—Ç—É—Å

- ‚úÖ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- ‚úÖ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –≤—ã—à–µ.

