# ===========================================
# POSTAL MAIL SERVER
# Configuration File
# ===========================================
#
# Настроен для работы с Docker Compose
# Использует TCP подключение к MariaDB
#
# ===========================================

# ===========================================
# GENERAL
# ===========================================
general:
  use_ip_pools: false

# ===========================================
# WEB INTERFACE
# ===========================================
web:
  host: ${DOMAIN}
  protocol: https

# ===========================================
# MAIN DATABASE (MariaDB)
# ===========================================
main_db:
  host: mariadb
  port: 3306
  username: postal
  password: ${MARIADB_PASSWORD}
  database: postal
  pool_size: 5
  socket: false

# ===========================================
# MESSAGE DATABASE
# ===========================================
message_db:
  host: mariadb
  port: 3306
  username: postal
  password: ${MARIADB_PASSWORD}
  prefix: postal
  socket: false

# ===========================================
# RABBITMQ
# ===========================================
rabbitmq:
  host: rabbitmq
  port: 5672
  username: postal
  password: ${RABBITMQ_PASSWORD}
  vhost: postal

# ===========================================
# SMTP SERVER
# ===========================================
smtp_server:
  port: 25
  log_connect: true
  proxy_protocol: false
  ssl_mode: starttls
  max_message_size: 14680064  # 14MB

# ===========================================
# DNS
# ===========================================
dns:
  mx_records:
    - ${DOMAIN}
  smtp_server_hostname: ${DOMAIN}
  return_path: rp.${DOMAIN}
  route_domain: routes.${DOMAIN}
  track_domain: ${DOMAIN}
  dkim_identifier: postal
  check_ptr: false

# ===========================================
# LOGGING
# ===========================================
logging:
  rails_log: true
  log_level: info

# ===========================================
# RAILS
# ===========================================
rails:
  secret_key: ${SECRET_KEY_BASE}
  environment: production

# ===========================================
# SMTP CLIENT
# ===========================================
smtp_client:
  open_timeout: 30
  read_timeout: 60
  helo_hostname: ${DOMAIN}

# ===========================================
# WEB SERVER
# ===========================================
web_server:
  bind_address: 0.0.0.0
  port: 5000

