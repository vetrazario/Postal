# –ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Postal –∏ AMS Enterprise

## üìö –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

### Postal Server
- **URL**: https://docs.postalserver.io/welcome/feature-list
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Postal Server - –ø–æ—á—Ç–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏ –ø–æ–ª—É—á–µ–Ω–∏—è email

### AMS Enterprise
- **URL**: https://www.bspdev.ru/Help/Ru/AMS/
- **–õ–æ–∫–∞–ª—å–Ω–∞—è –∫–æ–ø–∏—è**: `docs/AMS Enterprise 2.x - –§–∞–π–ª –°–ø—Ä–∞–≤–∫–∏ - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—ã–ª–∫–∞–º–∏ —á–µ—Ä–µ–∑ API.html`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è AMS Enterprise 2.x - —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è email-—Ä–∞—Å—Å—ã–ª–∫–∞–º–∏

---

## üìã –ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Postal

### ‚úÖ –ü—Ä–∏–º–µ–Ω—è–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ Postal –≤ –Ω–∞—à–µ–π —Å–∏—Å—Ç–µ–º–µ

#### 1. **HTTP API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ email**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: 
  - `PostalClient` (`services/api/app/services/postal_client.rb`)
  - `SendToPostalJob` (`services/api/app/jobs/send_to_postal_job.rb`)
  - `SendSmtpEmailJob` (`services/api/app/jobs/send_smtp_email_job.rb`)
- **–î–µ—Ç–∞–ª–∏**: –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ `POST /api/v1/send/message` —Å API –∫–ª—é—á–æ–º

#### 2. **Webhooks –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–æ—Å—Ç–∞–≤–∫–µ**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**:
  - `Api::V1::WebhooksController` (`services/api/app/controllers/api/v1/webhooks_controller.rb`)
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π: `MessageDelivered`, `MessageBounced`, `MessageHeld`
- **–î–µ—Ç–∞–ª–∏**: 
  - Endpoint: `POST /api/v1/webhook`
  - –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∏ —á–µ—Ä–µ–∑ `EncryptoSigno`
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –≤ `EmailLog`

#### 3. **DKIM –ø–æ–¥–ø–∏—Å—å –∏—Å—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ Postal)
- **–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è Postal –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ
- **–î–µ—Ç–∞–ª–∏**: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ Postal UI –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ mail server

#### 4. **Click and Open Tracking**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (—Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
- **–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**:
  - `TrackingInjector` - –∏–Ω—ä–µ–∫—Ü–∏—è tracking –ø–∏–∫—Å–µ–ª—è –∏ —Å—Å—ã–ª–æ–∫
  - `TrackingHandler` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –æ—Ç–∫—Ä—ã—Ç–∏—è/–∫–ª–∏–∫–∞
  - `TrackingEvent` - –º–æ–¥–µ–ª—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
- **–î–µ—Ç–∞–ª–∏**: 
  - Tracking –ø–∏–∫—Å–µ–ª—å: `/track/o?eid=...&cid=...&mid=...`
  - Tracking —Å—Å—ã–ª–∫–∏: `/track/c?url=...&eid=...&cid=...&mid=...`
  - **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é, –∞ –Ω–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π tracking Postal

#### 5. **Mail Tagging**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- **–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**:
  - `PostalClient#send_message` - –ø–∞—Ä–∞–º–µ—Ç—Ä `tag`
  - `SendToPostalJob` - –ø–µ—Ä–µ–¥–∞—á–∞ `campaign_id` –∫–∞–∫ tag
- **–î–µ—Ç–∞–ª–∏**: –¢–µ–≥–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–∏—Å–µ–º –ø–æ –∫–∞–º–ø–∞–Ω–∏—è–º

#### 6. **SMTP Server –¥–ª—è –ø—Ä–∏–µ–º–∞ email**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (—á–µ—Ä–µ–∑ Haraka SMTP Relay)
- **–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**:
  - `smtp-relay` —Å–µ—Ä–≤–∏—Å (Haraka) –ø—Ä–∏–Ω–∏–º–∞–µ—Ç SMTP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
  - –ü—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –≤ Postal —á–µ—Ä–µ–∑ HTTP API
- **–î–µ—Ç–∞–ª–∏**: 
  - Haraka –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 587
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
  - –ü–µ—Ä–µ–¥–∞–µ—Ç –≤ Postal —á–µ—Ä–µ–∑ –Ω–∞—à API

#### 7. **Multiple Credentials per Server**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**:
  - `SmtpCredential` –º–æ–¥–µ–ª—å
  - `Dashboard::SmtpCredentialsController`
- **–î–µ—Ç–∞–ª–∏**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö SMTP credentials –¥–ª—è AMS

#### 8. **Per-Server Send Limits**
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**:
  - `SmtpCredential#rate_limit` - –ª–∏–º–∏—Ç –Ω–∞ credential
  - `ApiKey#daily_limit` - –¥–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç –Ω–∞ API –∫–ª—é—á
- **–î–µ—Ç–∞–ª–∏**: –õ–∏–º–∏—Ç—ã –µ—Å—Ç—å, –Ω–æ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–Ω—É–∂–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è middleware)

#### 9. **Suppression List**
- **–°—Ç–∞—Ç—É—Å**: ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –±—É–¥—É—â–µ–º –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤

#### 10. **Message Retention Configuration**
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
- **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ Postal UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å–æ–æ–±—â–µ–Ω–∏–π

#### 11. **DNS Checking and Monitoring**
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: Postal –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ DNS –∑–∞–ø–∏—Å–µ–π (MX, SPF, DKIM, DMARC)

#### 12. **Historical Messages View**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (—á–µ—Ä–µ–∑ –Ω–∞—à Dashboard)
- **–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**:
  - `Dashboard::LogsController` - –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö email –ª–æ–≥–æ–≤
  - `EmailLog` –º–æ–¥–µ–ª—å - —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏
- **–î–µ—Ç–∞–ª–∏**: –ù–∞—à Dashboard –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –æ—Ç–ø—Ä–∞–≤–æ–∫, –Ω–æ –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å Postal UI

#### 13. **Graphs and Stats**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (—á–∞—Å—Ç–∏—á–Ω–æ)
- **–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**:
  - `Dashboard::DashboardController` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
  - `Dashboard::AnalyticsController` - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
  - `CampaignStats` –º–æ–¥–µ–ª—å - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–º–ø–∞–Ω–∏—è–º
- **–î–µ—Ç–∞–ª–∏**: –ë–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –µ—Å—Ç—å, –Ω–æ –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å

---

## üìã –ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ AMS Enterprise

### ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AMS –≤ –Ω–∞—à–µ–π —Å–∏—Å—Ç–µ–º–µ

#### 1. **SMTP –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ –Ω–∞—à SMTP Relay**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**:
  - AMS –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —á–µ—Ä–µ–∑ –Ω–∞—à SMTP Relay (–ø–æ—Ä—Ç 587)
  - Haraka –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
- **–î–µ—Ç–∞–ª–∏**: 
  - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ `SmtpCredential`
  - –ü–∞—Ä—Å–∏–Ω–≥ MIME —Å–æ–æ–±—â–µ–Ω–∏–π
  - –£–¥–∞–ª–µ–Ω–∏–µ AMS headers
  - –ò–Ω—ä–µ–∫—Ü–∏—è tracking

#### 2. **Webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ AMS**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**:
  - `ReportToAmsJob` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –≤ AMS
  - `WebhookSender` - —Å–µ—Ä–≤–∏—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ webhooks
  - `WebhookEndpoint` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è endpoints
- **–î–µ—Ç–∞–ª–∏**:
  - –°–æ–±—ã—Ç–∏—è: `sent`, `delivered`, `bounced`, `failed`, `opened`, `clicked`
  - –ü–æ–¥–ø–∏—Å—å —á–µ—Ä–µ–∑ HMAC SHA256
  - Retry –ª–æ–≥–∏–∫–∞

#### 3. **Campaign ID tracking**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**:
  - `EmailLog#campaign_id` - —Ö—Ä–∞–Ω–µ–Ω–∏–µ ID –∫–∞–º–ø–∞–Ω–∏–∏
  - –ü–µ—Ä–µ–¥–∞—á–∞ —á–µ—Ä–µ–∑ headers –∏–ª–∏ tracking –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- **–î–µ—Ç–∞–ª–∏**: AMS –ø–µ—Ä–µ–¥–∞–µ—Ç campaign_id, –º—ã –µ–≥–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∏ –ø–µ—Ä–µ–¥–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ –≤ webhooks

#### 4. **Message ID mapping**
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**:
  - `EmailLog#external_message_id` - ID –æ—Ç AMS
  - `EmailLog#message_id` - –Ω–∞—à –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π ID
  - `EmailLog#postal_message_id` - ID –æ—Ç Postal
- **–î–µ—Ç–∞–ª–∏**: –¢—Ä–µ—Ö—Å—Ç–æ—Ä–æ–Ω–Ω–µ–µ –º–∞–ø–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–∏—Å–µ–º

#### 5. **Template Management**
- **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- **–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**:
  - `EmailTemplate` –º–æ–¥–µ–ª—å
  - `BuildEmailJob` - —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —à–∞–±–ª–æ–Ω–æ–≤
- **–î–µ—Ç–∞–ª–∏**: –®–∞–±–ª–æ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è —É –Ω–∞—Å, –Ω–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AMS templates –Ω–µ –ø–æ–ª–Ω–∞—è

---

## üîå AMS Enterprise API (JSON-RPC 2.0)

### –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è API

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **–ü—Ä–æ—Ç–æ–∫–æ–ª** | JSON-RPC 2.0 |
| **–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç** | HTTP POST |
| **URL** | `http://IP:PORT/api/v1` –∏–ª–∏ `https://IP:PORT/api/v1` |
| **Content-Type** | `application/json` |
| **–ü–æ—Ä—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é** | 80 (HTTP), 443 (HTTPS) |
| **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** | `apiKey` –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ |

### –§–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞

```json
{
  "jsonrpc": "2.0",
  "method": "getMailings",
  "params": {
    "apiKey": "YOUR_API_KEY",
    ...–¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã...
  },
  "id": "1"
}
```

### –§–æ—Ä–º–∞—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞

```json
{
  "jsonrpc": "2.0",
  "result": { ...–¥–∞–Ω–Ω—ã–µ... },
  "id": 1
}
```

### –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ —Å –æ—à–∏–±–∫–æ–π

```json
{
  "jsonrpc": "2.0",
  "error": {
    "code": -32603,
    "message": "–¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏"
  },
  "id": 1
}
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–∑–æ–≤–∞ (curl)

```bash
curl -X POST http://127.0.0.1:80/api/v1 \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "getMailings",
    "params": {
      "apiKey": "38091FE7-5516-4F5B-9455-4A340BFEC875"
    },
    "id": "1"
  }'
```

---

## üìã –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ—á–µ–Ω—å –∫–æ–º–∞–Ω–¥ AMS API (52 –∫–æ–º–∞–Ω–¥—ã)

### üîπ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—ã–ª–∫–∞–º–∏ (9 –∫–æ–º–∞–Ω–¥)

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `addMailing` | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ä–∞—Å—Å—ã–ª–∫—É |
| `editMailing` | –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å—Å—ã–ª–∫–∏ |
| `deleteMailing` | –£–¥–∞–ª–∏—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É |
| `getMailings` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ä–∞—Å—Å—ã–ª–æ–∫ |
| `getTransactionalMailings` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–æ–ª—å–∫–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫ |
| `getMailing` | –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–∞—Å—Å—ã–ª–∫–µ |
| `startMailing` | –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É |
| `stopMailing` | –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É |
| `restartRunningMailings` | –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö —Ä–∞—Å—Å—ã–ª–æ–∫ |

### üîπ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–µ—Ç–Ω—ã–º–∏ –∑–∞–ø–∏—Å—è–º–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è (5 –∫–æ–º–∞–Ω–¥)

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `addSenderAccount` | –î–æ–±–∞–≤–∏—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è |
| `editSenderAccount` | –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ |
| `deleteSenderAccount` | –£–¥–∞–ª–∏—Ç—å —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å |
| `getSenderAccounts` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —É—á–µ—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π |
| `getSenderAccount` | –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ |

### üîπ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞–º–∏ —Ä–∞—Å—Å—ã–ª–∫–∏ (7 –∫–æ–º–∞–Ω–¥)

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `addMailingList` | –°–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ä–∞—Å—Å—ã–ª–∫–∏ |
| `editMailingList` | –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–ø–∏—Å–∫–∞ —Ä–∞—Å—Å—ã–ª–∫–∏ |
| `deleteMailingList` | –£–¥–∞–ª–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ä–∞—Å—Å—ã–ª–∫–∏ *(–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)* |
| `getMailingLists` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–º–µ—é—â–∏—Ö—Å—è —Å–ø–∏—Å–∫–æ–≤ —Ä–∞—Å—Å—ã–ª–∫–∏ |
| `getMailingListSize` | –ü–æ–ª—É—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Å–ø–∏—Å–∫–∞ —Ä–∞—Å—Å—ã–ª–∫–∏ |
| `getMailingListDataSet` | –ü–æ–ª—É—á–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–ø–∏—Å–∫–∞ —Ä–∞—Å—Å—ã–ª–∫–∏ |
| `clearMailingList` | –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Å–ø–∏—Å–∫–∞ —Ä–∞—Å—Å—ã–ª–∫–∏ |

### üîπ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ (–ø–æ–ª—É—á–∞—Ç–µ–ª—è–º–∏) (3 –∫–æ–º–∞–Ω–¥—ã)

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `addContacts` | –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –≤ —Å–ø–∏—Å–æ–∫ —Ä–∞—Å—Å—ã–ª–∫–∏ |
| `editContact` | –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—É—á–∞—Ç–µ–ª—è |
| `deleteContacts` | –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –∏–∑ —Å–ø–∏—Å–∫–∞ |

### üîπ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∏—Å—å–º–∞–º–∏/—à–∞–±–ª–æ–Ω–∞–º–∏ (5 –∫–æ–º–∞–Ω–¥)

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `addMessage` | –°–æ–∑–¥–∞—Ç—å –ø–∏—Å—å–º–æ |
| `editMessage` | –ò–∑–º–µ–Ω–∏—Ç—å –ø–∏—Å—å–º–æ |
| `deleteMessage` | –£–¥–∞–ª–∏—Ç—å –ø–∏—Å—å–º–æ |
| `getMessages` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–∏—Å–µ–º |
| `getMessage` | –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–∏—Å—å–º–µ |

### üîπ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è–º–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ (6 –∫–æ–º–∞–Ω–¥)

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `addDeliveryPreset` | –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –æ—Ç–ø—Ä–∞–≤–∫–∏ |
| `editDeliveryPreset` | –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è |
| `deleteDeliveryPreset` | –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –æ—Ç–ø—Ä–∞–≤–∫–∏ |
| `getDeliveryPresets` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ—Ñ–∏–ª–µ–π |
| `getDeliveryPreset` | –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ñ–∏–ª–µ |
| `toggleRelaysInPreset` | –ú–∞—Å—Å–æ–≤–æ–µ –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ SMTP —Ä–µ–ª–µ–µ–≤ |

### üîπ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∞–º–∏ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (amsweb.php) (4 –∫–æ–º–∞–Ω–¥—ã)

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `addAmswebLink` | –î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ amsweb.php |
| `editAmswebLink` | –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Å—ã–ª–∫–∏ |
| `deleteAmswebLink` | –£–¥–∞–ª–∏—Ç—å —Å—Å—ã–ª–∫—É |
| `getAmswebLinks` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å—Å—ã–ª–æ–∫ |

### üîπ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ DKIM –ø–æ–¥–ø–∏—Å—è–º–∏ (5 –∫–æ–º–∞–Ω–¥)

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `addDkimSignature` | –î–æ–±–∞–≤–∏—Ç—å DKIM –ø–æ–¥–ø–∏—Å—å |
| `editDkimSignature` | –ò–∑–º–µ–Ω–∏—Ç—å DKIM –ø–æ–¥–ø–∏—Å—å |
| `deleteDkimSignature` | –£–¥–∞–ª–∏—Ç—å DKIM –ø–æ–¥–ø–∏—Å—å |
| `getDkimSignatures` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ DKIM –ø–æ–¥–ø–∏—Å–µ–π |
| `getDkimSignature` | –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–¥–ø–∏—Å–∏ |

### üîπ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Postmaster Mail.ru –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏ (4 –∫–æ–º–∞–Ω–¥—ã)

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `addPostmasterAccount` | –î–æ–±–∞–≤–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç postmaster.mail.ru |
| `editPostmasterAccount` | –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞ |
| `deletePostmasterAccount` | –£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç |
| `getPostmasterAccounts` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ |

### üîπ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞–º–∏ –ø—Ä–æ–∫—Å–∏ (6 –∫–æ–º–∞–Ω–¥)

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `addProxyList` | –°–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–∫—Å–∏ |
| `editProxyList` | –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–ø–∏—Å–∫–∞ |
| `deleteProxyList` | –£–¥–∞–ª–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–∫—Å–∏ |
| `updateProxyList` | –ó–∞–¥–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–æ–∫—Å–∏ –ª–∏—Å—Ç–∞ |
| `getProxyLists` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–∫—Å–∏ –ª–∏—Å—Ç–æ–≤ |
| `getProxyList` | –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–∫—Å–∏ –ª–∏—Å—Ç–µ |

### üîπ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ SMTP —Ä–µ–ª–µ–µ–≤ –≤ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–∞—Å—Å—ã–ª–∫–∞—Ö (2 –∫–æ–º–∞–Ω–¥—ã)

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `getRelaysSendingStates` | –ü–æ–ª—É—á–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–µ–ª–µ–µ–≤ (–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ, –æ—à–∏–±–∫–∏) |
| `changeRelaySendingOption` | –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–µ–ª–µ—è —É –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ |

### üîπ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–∫—Å–∏ –≤ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–∞—Å—Å—ã–ª–∫–∞—Ö (2 –∫–æ–º–∞–Ω–¥—ã)

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `getProxiesSendingStates` | –ü–æ–ª—É—á–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ–∫—Å–∏ (–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ, –æ—à–∏–±–∫–∏) |
| `changeProxySendingOption` | –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ–∫—Å–∏ —É –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ |

### üîπ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–µ —Ä–∞—Å—Å—ã–ª–∫–∏ (2 –∫–æ–º–∞–Ω–¥—ã)

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `postSendingJob` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ –≤ –æ—á–µ—Ä–µ–¥—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏ |
| `getSendingJobResult` | –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–¥–∞–Ω–∏—è |

### üîπ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º (2 –∫–æ–º–∞–Ω–¥—ã)

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `isSchedulerRunning` | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–ø—É—â–µ–Ω –ª–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ |
| `runScheduler` | –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Ä–∞—Å—Å—ã–ª–æ–∫ |

---

## üî• –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã AMS API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### 1. `getMailings` - –°–ø–∏—Å–æ–∫ —Ä–∞—Å—Å—ã–ª–æ–∫ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º

**–û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:**
```json
{
  "id": 73,
  "name": "Example Mailing",
  "type": "mailing",
  "state": "idle",  // idle, running, paused
  "createDate": "2003-11-13",
  "lastStartDate": "2023-10-18T08:13:15.568",
  "approxSpeed": "0/min",
  "progressInfo": {
    "percentDone": 0,
    "total": 1,
    "sent": 0,
    "notSent": 0,
    "bad": 0,
    "refused": 0,
    "excluded": 0,
    "opened": 0,
    "clicks": 0
  }
}
```

### 2. `getSendingJobResult` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –ø–∏—Å–µ–º

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `apiKey` - –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞ –∫ API
- `jobID` - ID –∑–∞–¥–∞–Ω–∏—è
- `mailingID` - ID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏

**–û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –∫–∞–∂–¥–æ–º—É –ø–æ–ª—É—á–∞—Ç–µ–ª—é:**
```json
{
  "ID": "1",
  "Email": "user@example.com",
  "sendResult": "sent",        // pending, sent, failed, excluded
  "lastReply": "250 DATA received; Message accepted",
  "failCategory": "bad email"  // bad email, refused content or IP, other
}
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è `sendResult`:**
- `pending` - –∑–∞–¥–∞–Ω–∏–µ –µ—â—ë –≤ –æ—á–µ—Ä–µ–¥–∏ –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
- `sent` - –ø–∏—Å—å–º–æ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ
- `failed` - –æ—à–∏–±–∫–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ (—Ç–µ–∫—Å—Ç –≤ `lastReply`)
- `excluded` - email –≤ —Å–ø–∏—Å–∫–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

**–í–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è `failCategory`:**
- `bad email` - –∞–¥—Ä–µ—Å "–ø–ª–æ—Ö–æ–π" (user not found –∏ —Ç.–¥.)
- `refused content or IP` - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∏–ª–∏ IP
- `other` - –¥—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ (—Ç–∞–π–º–∞—É—Ç, —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ —Ç.–¥.)

### 3. `startMailing` / `stopMailing` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—ã–ª–∫–∞–º–∏

```json
{
  "jsonrpc": "2.0",
  "method": "stopMailing",
  "params": {
    "apiKey": "YOUR_API_KEY",
    "id": 73
  },
  "id": "1"
}
```

### 4. `getRelaysSendingStates` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ SMTP —Ä–µ–ª–µ—è–º

–ü–æ–ª—É—á–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–µ–ª–µ–µ–≤ —É –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏:
- –ß–∏—Å–ª–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø–∏—Å–µ–º
- –û—à–∏–±–∫–∏
- –°—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã

---

## üîÑ –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –≤ —Å–∏—Å—Ç–µ–º–µ

### –û—Ç–ø—Ä–∞–≤–∫–∞ email (AMS ‚Üí Postal)
```
AMS Enterprise
  ‚Üì SMTP (port 587, TLS + AUTH)
Haraka SMTP Relay
  ‚îú‚îÄ> Authenticate (PostgreSQL)
  ‚îú‚îÄ> Parse MIME
  ‚îú‚îÄ> Remove AMS headers
  ‚îú‚îÄ> Inject tracking
  ‚îî‚îÄ> POST /api/v1/smtp/receive
      ‚Üì
Rails API Controller
  ‚îú‚îÄ> Create EmailLog
  ‚îî‚îÄ> Queue SendSmtpEmailJob
      ‚Üì
Sidekiq Worker
  ‚îú‚îÄ> Build Postal payload
  ‚îî‚îÄ> POST to Postal API
      ‚Üì
Postal Mail Server
  ‚îú‚îÄ> Sign with DKIM
  ‚îî‚îÄ> Send via SMTP
      ‚Üì
Internet (recipient)
```

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å (Postal ‚Üí AMS)
```
Postal Mail Server
  ‚îú‚îÄ> MessageDelivered event
  ‚îú‚îÄ> MessageBounced event
  ‚îî‚îÄ> POST /api/v1/webhook
      ‚Üì
Rails API Controller
  ‚îú‚îÄ> Verify signature
  ‚îú‚îÄ> Update EmailLog status
  ‚îî‚îÄ> Queue ReportToAmsJob
      ‚Üì
Sidekiq Worker
  ‚îî‚îÄ> POST webhook to AMS
      ‚Üì
AMS Enterprise
```

### Tracking —Å–æ–±—ã—Ç–∏—è
```
Recipient opens email
  ‚Üì GET /track/o?eid=...&cid=...&mid=...
Tracking Service
  ‚îú‚îÄ> Decode parameters
  ‚îú‚îÄ> Find EmailLog
  ‚îú‚îÄ> Create TrackingEvent
  ‚îî‚îÄ> Queue ReportToAmsJob
      ‚Üì
AMS Enterprise (webhook)
```

### –ù–æ–≤–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å: –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ AMS API
```
Dashboard (–Ω–∞—à)
  ‚Üì AmsClient (JSON-RPC 2.0)
AMS Enterprise API
  ‚îú‚îÄ> getMailings - –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ä–∞—Å—Å—ã–ª–æ–∫
  ‚îú‚îÄ> getSendingJobResult - –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–ø—Ä–∞–≤–∫–∏
  ‚îú‚îÄ> stopMailing - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É
  ‚îî‚îÄ> getRelaysSendingStates - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–ª–µ–µ–≤
      ‚Üì
Dashboard –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ AMS
```

---

## üìù –ó–∞–º–µ—Ç–∫–∏ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ:
- ‚úÖ SMTP Relay –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∏—Å—å–º–∞ –æ—Ç AMS
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Postal API —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ Webhooks –æ—Ç Postal –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
- ‚úÖ Tracking —Å–æ–±—ã—Ç–∏—è —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è
- ‚úÖ Webhooks –≤ AMS –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è

### –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å:
- ‚ö†Ô∏è –ü–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏
- ‚ö†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å–æ–±—ã—Ç–∏–π Postal (MessageOpened, MessageLinkClicked)
- ‚ö†Ô∏è Retry –ª–æ–≥–∏–∫–∞ –¥–ª—è failed webhooks
- ‚ö†Ô∏è –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥

### –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è AMS API:
- üÜï –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å SMTP –æ—Ç–≤–µ—Ç–∞–º–∏ –æ—Ç –ø–æ—á—Ç–æ–≤—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
- üÜï –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—ã–ª–∫–∞–º–∏ –∏–∑ –¥–∞—à–±–æ—Ä–¥–∞ (–∑–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞)
- üÜï –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∏ —Å–ø–∏—Å–∫–æ–≤ —Ä–∞—Å—Å—ã–ª–∫–∏
- üÜï –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ SMTP —Ä–µ–ª–µ–µ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üÜï –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞—Å—Å—ã–ª–∫–∏ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–∞ –æ—à–∏–±–æ–∫

### –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Postal:
1. **Webhooks**: Postal –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç webhooks —Å –ø–æ–¥–ø–∏—Å—å—é RSA. –ù—É–∂–µ–Ω `POSTAL_WEBHOOK_PUBLIC_KEY`
2. **API Keys**: –ö–∞–∂–¥—ã–π mail server –∏–º–µ–µ—Ç —Å–≤–æ–π API –∫–ª—é—á
3. **Message IDs**: Postal –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç message ID –∏ token –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
4. **Tags**: –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–∏—Å–µ–º
5. **Retention**: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ Postal UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º

### –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ AMS:
1. **API Server**: –ù—É–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –≤ AMS: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ API ‚Üí –í–∫–ª—é—á–∏—Ç—å API —Å–µ—Ä–≤–µ—Ä
2. **–ü–æ—Ä—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**: 80 (HTTP) –∏–ª–∏ 443 (HTTPS), –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å
3. **API Key**: –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ AMS, –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å
4. **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**: –ö–æ–º–∞–Ω–¥—ã API –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤ –≥–ª–∞–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ
5. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã, –µ—Å–ª–∏ —Ä–µ—Å—É—Ä—Å –∑–∞–Ω—è—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≤ UI

---

## üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç—ã

### –ö—Ä–∏—Ç–∏—á–Ω–æ:
1. ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ webhook —Å–æ–±—ã—Ç–∏—è –æ—Ç Postal –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
2. üÜï –°–æ–∑–¥–∞—Ç—å —Å–µ—Ä–≤–∏—Å `AmsClient` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å AMS API

### –í–∞–∂–Ω–æ:
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å retry –ª–æ–≥–∏–∫—É –¥–ª—è failed webhooks –≤ AMS
4. –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
5. üÜï –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –¥–∞—à–±–æ—Ä–¥–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ä–∞—Å—Å—ã–ª–æ–∫ –∏–∑ AMS
6. üÜï –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–∫–∏ —á–µ—Ä–µ–∑ `getSendingJobResult`

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ:
7. –†–∞—Å—à–∏—Ä–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫—É
8. –î–æ–±–∞–≤–∏—Ç—å suppression list –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤
9. üÜï –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞—Å—Å—ã–ª–∫–∏ –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–º —É—Ä–æ–≤–Ω–µ –æ—à–∏–±–æ–∫
10. üÜï –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è DKIM –ø–æ–¥–ø–∏—Å–µ–π –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏

---

## ‚öôÔ∏è –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –î–ª—è Postal:
| –ù–∞—Å—Ç—Ä–æ–π–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ì–¥–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è |
|-----------|----------|-------------------|
| `POSTAL_API_URL` | URL API Postal | ENV / SystemSetting |
| `POSTAL_API_KEY` | API –∫–ª—é—á —Å–µ—Ä–≤–µ—Ä–∞ | ENV / SystemSetting |
| `POSTAL_WEBHOOK_PUBLIC_KEY` | –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ webhooks | ENV / SystemSetting |

### –î–ª—è AMS Enterprise:
| –ù–∞—Å—Ç—Ä–æ–π–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ì–¥–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è |
|-----------|----------|-------------------|
| `AMS_API_URL` | URL API AMS (–Ω–∞–ø—Ä–∏–º–µ—Ä `http://192.168.1.100:80/api/v1`) | ENV / SystemSetting |
| `AMS_API_KEY` | –ö–ª—é—á –¥–æ—Å—Ç—É–ø–∞ –∫ AMS API | ENV / SystemSetting |

### –û–±—â–∏–µ:
| –ù–∞—Å—Ç—Ä–æ–π–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ì–¥–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è |
|-----------|----------|-------------------|
| `DOMAIN` | –û—Å–Ω–æ–≤–Ω–æ–π –¥–æ–º–µ–Ω —Å–∏—Å—Ç–µ–º—ã | ENV / SystemSetting |
| `ALLOWED_SENDER_DOMAINS` | –†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª–µ–π | ENV / SystemSetting |

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2024-12-27
**–°—Ç–∞—Ç—É—Å**: –ê–∫—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞**: 2.0

